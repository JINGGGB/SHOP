<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>å¥¶èŒ¶å®šåˆ¶ - ç‰¹æƒ </title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: {
                            light: "#FF8C4B",
                            dark: "#F97316"
                        },
                        "background-light": "#F8FAFC",
                        "background-dark": "#18181B",
                        "surface-light": "#FFFFFF",
                        "surface-dark": "#27272A",
                        "text-primary-light": "#18181B",
                        "text-primary-dark": "#F8FAFC",
                        "text-secondary-light": "#64748B",
                        "text-secondary-dark": "#94A3B8",
                        "border-light": "#E2E8F0",
                        "border-dark": "#3F3F46",
                    },
                    fontFamily: {
                        display: ["Noto Sans SC", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "1rem",
                        "2xl": "1.5rem"
                    },
                    boxShadow: {
                        'soft-glow-light': '0 4px 14px 0 rgba(255, 178, 112, 0.3)',
                        'soft-glow-dark': '0 4px 14px 0 rgba(249, 115, 22, 0.2)',
                    }
                },
            },
        };
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        /* é€‰ä¸­åŠ¨ç”» */
        .option-btn {
            transition: all 0.2s ease;
        }
        .option-btn:hover {
            transform: scale(1.05);
        }
        .option-btn.selected {
            animation: pulse-once 0.3s ease;
        }
        @keyframes pulse-once {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* ç¡®è®¤æŒ‰é’®åŠ¨ç”» */
        .confirm-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 140, 75, 0.4);
        }
        .confirm-btn:active {
            transform: translateY(0);
        }

        /* æ•°é‡é€‰æ‹©å™¨ */
        .quantity-btn:hover {
            background-color: #fbbf24;
            color: white;
        }

        /* ç‰¹æƒ æ ‡ç­¾åŠ¨ç”» */
        .special-badge {
            animation: float 2s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display flex items-center justify-center min-h-screen p-4">
    <div class="relative w-full max-w-sm mx-auto bg-surface-light dark:bg-surface-dark rounded-2xl shadow-xl overflow-hidden">
        <!-- å¤´éƒ¨ -->
        <div class="p-4 bg-gradient-to-r from-orange-200 to-rose-200 dark:from-orange-800/50 dark:to-rose-800/50">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-2 text-zinc-800 dark:text-zinc-200">
                    <span class="material-symbols-outlined text-amber-900 dark:text-amber-400">local_cafe</span>
                    <h2 class="font-semibold text-lg">ä¸ªæ€§åŒ–å®šåˆ¶</h2>
                </div>
                <button onclick="goBack()" class="text-zinc-500 dark:text-zinc-400 hover:text-zinc-800 dark:hover:text-zinc-200 transition-colors">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
        </div>

        <!-- å†…å®¹åŒºåŸŸ -->
        <div class="p-6 space-y-6">
            <!-- å•†å“ä¿¡æ¯ -->
            <div class="flex items-center gap-4">
                <div id="product-image" class="w-24 h-24 flex items-center justify-center text-6xl bg-amber-50 dark:bg-amber-900/20 rounded-lg">
                    ğŸ§‹
                </div>
                <div class="flex-1">
                    <h3 id="product-name" class="text-xl font-bold text-text-primary-light dark:text-text-primary-dark">çç å¥¶èŒ¶</h3>
                    <p id="product-price" class="text-lg font-bold text-red-500 mt-1">Â¥15</p>
                    <p id="product-desc" class="text-sm text-text-secondary-light dark:text-text-secondary-dark mt-1">ç»å…¸å°å¼çç å¥¶èŒ¶</p>
                </div>
                <div class="flex flex-col items-center special-badge">
                    <div class="relative inline-flex items-center justify-center p-2 rounded-full bg-amber-400/20 dark:bg-amber-400/30">
                        <span class="material-symbols-outlined text-amber-500 dark:text-amber-400 text-3xl" style="font-variation-settings: 'FILL' 1;">auto_awesome</span>
                    </div>
                    <p class="text-sm font-medium text-amber-600 dark:text-amber-400 mt-1">ç‰¹æƒ </p>
                </div>
            </div>

            <!-- ç”œåº¦é€‰æ‹© -->
            <div id="sweetness-section" class="p-4 border border-border-light dark:border-border-dark rounded-lg">
                <div class="flex items-center gap-2 mb-4">
                    <span class="material-symbols-outlined text-amber-900 dark:text-amber-400 text-xl">local_cafe</span>
                    <h4 class="font-semibold text-text-primary-light dark:text-text-primary-dark">é€‰æ‹©ç”œåº¦</h4>
                </div>
                <div class="grid grid-cols-3 gap-3 text-sm" id="sweetness-options">
                    <button onclick="selectSweetness(this, '0ç³–')" class="option-btn py-2 px-3 bg-zinc-100 dark:bg-zinc-700 rounded-lg text-text-secondary-light dark:text-text-secondary-dark">0ç³–</button>
                    <button onclick="selectSweetness(this, '3åˆ†ç³–')" class="option-btn py-2 px-3 bg-zinc-100 dark:bg-zinc-700 rounded-lg text-text-secondary-light dark:text-text-secondary-dark">3åˆ†ç³–</button>
                    <button onclick="selectSweetness(this, '5åˆ†ç³–')" class="option-btn py-2 px-3 bg-zinc-100 dark:bg-zinc-700 rounded-lg text-text-secondary-light dark:text-text-secondary-dark">5åˆ†ç³–</button>
                    <button onclick="selectSweetness(this, '7åˆ†ç³–')" class="option-btn py-2 px-3 bg-zinc-100 dark:bg-zinc-700 rounded-lg text-text-secondary-light dark:text-text-secondary-dark">7åˆ†ç³–</button>
                    <button onclick="selectSweetness(this, 'å…¨ç³–')" class="option-btn py-2 px-3 bg-zinc-100 dark:bg-zinc-700 rounded-lg text-text-secondary-light dark:text-text-secondary-dark">å…¨ç³–</button>
                </div>
            </div>

            <!-- å†°åº¦é€‰æ‹© -->
            <div id="ice-section" class="p-4 border border-border-light dark:border-border-dark rounded-lg">
                <div class="flex items-center gap-2 mb-4">
                    <span class="material-symbols-outlined text-blue-500 dark:text-blue-400 text-xl">ac_unit</span>
                    <h4 class="font-semibold text-text-primary-light dark:text-text-primary-dark">é€‰æ‹©å†°åº¦</h4>
                </div>
                <div class="grid grid-cols-4 gap-3 text-sm" id="ice-options">
                    <button onclick="selectIce(this, 'æ­£å¸¸å†°')" class="option-btn py-2 px-3 bg-zinc-100 dark:bg-zinc-700 rounded-lg text-text-secondary-light dark:text-text-secondary-dark">æ­£å¸¸å†°</button>
                    <button onclick="selectIce(this, 'å°‘å†°')" class="option-btn py-2 px-3 bg-zinc-100 dark:bg-zinc-700 rounded-lg text-text-secondary-light dark:text-text-secondary-dark">å°‘å†°</button>
                    <button onclick="selectIce(this, 'å»å†°')" class="option-btn py-2 px-3 bg-zinc-100 dark:bg-zinc-700 rounded-lg text-text-secondary-light dark:text-text-secondary-dark">å»å†°</button>
                    <button onclick="selectIce(this, 'æ¸©')" class="option-btn py-2 px-3 bg-zinc-100 dark:bg-zinc-700 rounded-lg text-text-secondary-light dark:text-text-secondary-dark">æ¸©</button>
                </div>
            </div>

            <!-- æ•°é‡é€‰æ‹© -->
            <div class="p-4 border border-border-light dark:border-border-dark rounded-lg">
                <div class="flex items-center gap-2 mb-4">
                    <span class="material-symbols-outlined text-green-500 dark:text-green-400 text-xl">shopping_cart</span>
                    <h4 class="font-semibold text-text-primary-light dark:text-text-primary-dark">é€‰æ‹©æ•°é‡</h4>
                </div>
                <div class="flex items-center justify-center gap-6">
                    <button onclick="changeQuantity(-1)" class="quantity-btn w-10 h-10 flex items-center justify-center bg-zinc-100 dark:bg-zinc-700 rounded-full text-xl font-bold text-text-primary-light dark:text-text-primary-dark transition-colors">
                        -
                    </button>
                    <span id="quantity" class="text-2xl font-bold text-text-primary-light dark:text-text-primary-dark w-12 text-center">1</span>
                    <button onclick="changeQuantity(1)" class="quantity-btn w-10 h-10 flex items-center justify-center bg-zinc-100 dark:bg-zinc-700 rounded-full text-xl font-bold text-text-primary-light dark:text-text-primary-dark transition-colors">
                        +
                    </button>
                </div>
            </div>
        </div>

        <!-- åº•éƒ¨æŒ‰é’® -->
        <div class="p-4 bg-surface-light dark:bg-surface-dark border-t border-border-light dark:border-border-dark">
            <div class="flex justify-between items-center mb-4">
                <span class="text-text-secondary-light dark:text-text-secondary-dark">æ€»è®¡</span>
                <span id="total-price" class="text-2xl font-bold text-red-500">Â¥15</span>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <button onclick="goBack()" class="py-3 px-6 bg-zinc-200 dark:bg-zinc-700 text-text-primary-light dark:text-text-primary-dark font-semibold rounded-full transition-all hover:bg-zinc-300 dark:hover:bg-zinc-600">
                    å–æ¶ˆ
                </button>
                <button onclick="confirmOrder()" class="confirm-btn relative py-3 px-6 bg-gradient-to-r from-orange-400 to-rose-500 text-white font-semibold rounded-full shadow-soft-glow-light dark:shadow-soft-glow-dark transition-all">
                    <span class="absolute top-1/2 left-4 -translate-y-1/2 text-white/50 text-sm">âœ¨</span>
                    <span class="absolute top-1/2 right-4 -translate-y-1/2 text-white/50 text-sm">âœ¨</span>
                    ç¡®è®¤è´­ä¹°
                </button>
            </div>
        </div>
    </div>

    <!-- æˆåŠŸæç¤º -->
    <div id="success-toast" class="fixed top-4 left-1/2 -translate-x-1/2 bg-green-500 text-white px-6 py-3 rounded-full shadow-lg transform -translate-y-20 opacity-0 transition-all duration-300 flex items-center gap-2">
        <span class="material-symbols-outlined">check_circle</span>
        <span>ä¸‹å•æˆåŠŸï¼</span>
    </div>

    <script>
        // å•†å“æ•°æ®
        let product = {
            id: 1,
            name: 'çç å¥¶èŒ¶',
            price: 15,
            image: 'ğŸ§‹',
            description: 'ç»å…¸å°å¼çç å¥¶èŒ¶',
            hasSweetness: true,
            hasIceLevel: true
        };

        // é€‰æ‹©çŠ¶æ€
        let selectedSweetness = null;
        let selectedIce = null;
        let quantity = 1;

        // ä» URL å‚æ•°è·å–å•†å“ä¿¡æ¯
        function loadProductFromURL() {
            const params = new URLSearchParams(window.location.search);

            if (params.has('id')) product.id = parseInt(params.get('id'));
            if (params.has('name')) product.name = decodeURIComponent(params.get('name'));
            if (params.has('price')) product.price = parseFloat(params.get('price'));
            if (params.has('image')) product.image = decodeURIComponent(params.get('image'));
            if (params.has('desc')) product.description = decodeURIComponent(params.get('desc'));
            if (params.has('sweetness')) product.hasSweetness = params.get('sweetness') === 'true';
            if (params.has('ice')) product.hasIceLevel = params.get('ice') === 'true';

            // æ›´æ–°é¡µé¢æ˜¾ç¤º
            document.getElementById('product-name').textContent = product.name;
            document.getElementById('product-price').textContent = 'Â¥' + product.price;
            document.getElementById('product-image').textContent = product.image;
            document.getElementById('product-desc').textContent = product.description;

            // éšè—ä¸éœ€è¦çš„é€‰é¡¹
            if (!product.hasSweetness) {
                document.getElementById('sweetness-section').style.display = 'none';
                selectedSweetness = 'é»˜è®¤';
            }
            if (!product.hasIceLevel) {
                document.getElementById('ice-section').style.display = 'none';
                selectedIce = 'é»˜è®¤';
            }

            updateTotalPrice();
        }

        // é€‰æ‹©ç”œåº¦
        function selectSweetness(btn, value) {
            // æ¸…é™¤ä¹‹å‰çš„é€‰æ‹©
            document.querySelectorAll('#sweetness-options button').forEach(b => {
                b.classList.remove('bg-white', 'dark:bg-zinc-900', 'border-2', 'border-amber-400', 'dark:border-amber-500', 'text-amber-900', 'dark:text-amber-400', 'font-semibold', 'selected');
                b.classList.add('bg-zinc-100', 'dark:bg-zinc-700', 'text-text-secondary-light', 'dark:text-text-secondary-dark');
                // ç§»é™¤å‹¾é€‰æ ‡è®°
                const check = b.querySelector('.check-mark');
                if (check) check.remove();
            });

            // æ·»åŠ é€‰ä¸­æ ·å¼
            btn.classList.remove('bg-zinc-100', 'dark:bg-zinc-700', 'text-text-secondary-light', 'dark:text-text-secondary-dark');
            btn.classList.add('bg-white', 'dark:bg-zinc-900', 'border-2', 'border-amber-400', 'dark:border-amber-500', 'text-amber-900', 'dark:text-amber-400', 'font-semibold', 'selected');

            // æ·»åŠ å‹¾é€‰æ ‡è®°
            const checkMark = document.createElement('span');
            checkMark.className = 'check-mark absolute -top-2 -right-2 flex items-center justify-center w-5 h-5 bg-blue-500 rounded-full text-white';
            checkMark.innerHTML = '<span class="material-symbols-outlined text-sm">done</span>';
            btn.style.position = 'relative';
            btn.appendChild(checkMark);

            selectedSweetness = value;
        }

        // é€‰æ‹©å†°åº¦
        function selectIce(btn, value) {
            // æ¸…é™¤ä¹‹å‰çš„é€‰æ‹©
            document.querySelectorAll('#ice-options button').forEach(b => {
                b.classList.remove('bg-white', 'dark:bg-zinc-900', 'border-2', 'border-blue-400', 'dark:border-blue-500', 'text-blue-900', 'dark:text-blue-400', 'font-semibold', 'selected');
                b.classList.add('bg-zinc-100', 'dark:bg-zinc-700', 'text-text-secondary-light', 'dark:text-text-secondary-dark');
                const check = b.querySelector('.check-mark');
                if (check) check.remove();
            });

            // æ·»åŠ é€‰ä¸­æ ·å¼
            btn.classList.remove('bg-zinc-100', 'dark:bg-zinc-700', 'text-text-secondary-light', 'dark:text-text-secondary-dark');
            btn.classList.add('bg-white', 'dark:bg-zinc-900', 'border-2', 'border-blue-400', 'dark:border-blue-500', 'text-blue-900', 'dark:text-blue-400', 'font-semibold', 'selected');

            // æ·»åŠ å‹¾é€‰æ ‡è®°
            const checkMark = document.createElement('span');
            checkMark.className = 'check-mark absolute -top-2 -right-2 flex items-center justify-center w-5 h-5 bg-blue-500 rounded-full text-white';
            checkMark.innerHTML = '<span class="material-symbols-outlined text-sm">done</span>';
            btn.style.position = 'relative';
            btn.appendChild(checkMark);

            selectedIce = value;
        }

        // ä¿®æ”¹æ•°é‡
        function changeQuantity(delta) {
            quantity = Math.max(1, Math.min(99, quantity + delta));
            document.getElementById('quantity').textContent = quantity;
            updateTotalPrice();
        }

        // æ›´æ–°æ€»ä»·
        function updateTotalPrice() {
            const total = product.price * quantity;
            document.getElementById('total-price').textContent = 'Â¥' + total;
        }

        // è¿”å›
        function goBack() {
            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.location.href = 'index.html';
            }
        }

        // ç¡®è®¤è®¢å•
        function confirmOrder() {
            // éªŒè¯é€‰æ‹©
            if (product.hasSweetness && !selectedSweetness) {
                alert('è¯·é€‰æ‹©ç”œåº¦');
                return;
            }
            if (product.hasIceLevel && !selectedIce) {
                alert('è¯·é€‰æ‹©å†°åº¦');
                return;
            }

            // æ„å»ºè®¢å•ä¿¡æ¯
            const order = {
                productId: product.id,
                productName: product.name,
                productImage: product.image,
                price: product.price,
                quantity: quantity,
                totalPrice: product.price * quantity,
                customization: {
                    sweetness: selectedSweetness || 'é»˜è®¤',
                    iceLevel: selectedIce || 'é»˜è®¤'
                }
            };

            console.log('è®¢å•ä¿¡æ¯:', order);

            // æ˜¾ç¤ºæˆåŠŸæç¤º
            const toast = document.getElementById('success-toast');
            toast.classList.remove('-translate-y-20', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');

            // 2ç§’åè¿”å›
            setTimeout(() => {
                toast.classList.add('-translate-y-20', 'opacity-0');
                toast.classList.remove('translate-y-0', 'opacity-100');

                setTimeout(() => {
                    goBack();
                }, 300);
            }, 1500);
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', loadProductFromURL);
    </script>
</body>
</html>
